<#include '/admin/sonheader.html' >
<#assign dateformat= "com.enation.framework.directive.DateformateDirective"?new()>
<style>
.layui-form-pane .layui-input:focus, .layui-form-pane .layui-textarea:focus
	{
	border-radius: 2px;
	border-color: #01AAED !important;
}
</style>
<div class="main">
   	<!--表单区域  -->
	<form id="addForm" class="layui-form" enctype="multipart/form-data" style="padding-top: 10px">
	   <div class="layui-form-item">
			<label class="layui-form-label">分类:</label>
			<div class="layui-input-block" style="width:300px;">
      			<select name="cat_id">
      			     <#list catList as cat>
						<option <#if cat.cat_id == data.cat_id>
	      			     			selected='selected'
	      			     		</#if>
	      			     	value="${cat.cat_id}">${cat.cat_name}</option>
					</#list>
      			</select>
   			</div>
		</div>
  		<div class="layui-form-item" style="width:400px;">
    		<label class="layui-form-label">电影名称：</label>
    		<div class="layui-input-block">
      			<input type="text" name="title" maxlength="60" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">电影主图：</label>
    		<div class="layui-upload">
				<button type="button" class="layui-btn" id="test1">上传图片</button>
			  	<div class="layui-upload-list">
			    	<img class="layui-upload-img" id="demo1">
			    	<p id="demoText"></p>
			  	</div>
			</div>
  		</div>
  		<div class="layui-form-item" style="width:400px;">
    		<label class="layui-form-label">电影时长：</label>
    		<div class="layui-input-block">
      			<input type="text" name="movieTimeLength" maxlength="60" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item" style="width:400px;">
    		<label class="layui-form-label">放映时间：</label>
    		<div class="layui-input-inline">
		        <input class="layui-input" id="test5" name="movieTime" placeholder="yyyy-MM-dd HH:mm:ss" type="text">
		    </div>
  		</div>
  		<div class="layui-form-item" style="width:400px;">
    		<label class="layui-form-label">放映地点：</label>
    		<div class="layui-input-block">
      			<input type="text" name="movieAddr" maxlength="60" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item layui-form-text" style="width:600px;">
		    <label class="layui-form-label">影片介绍：</label>
		    <div class="layui-input-block">
		      <textarea placeholder="请输入内容" id="movieIntroduce" lay-verify="required" name="movieIntroduce" class="layui-textarea"></textarea>
		    </div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">电影详情：</label>
    		<fieldset class="layui-elem-field site-demo-button" style="margin-top: 30px;width: 640px;">
				<legend>影片花絮</legend>
				<div class="layui-form-item">
					<a class="layui-btn" onclick="return addImg();">增加图片</a>
					<a class="layui-btn" onclick="return getFilmImg();">1</a>
	  			</div>
				 <div id="film" class="layui-form-item">
				  	<div id="filmImg" class="layui-inline">
					  	<div class="layui-inline">
							<img name="img" src="http://localhost:8081/static/img.jpg"  width="112" height="112" />	
					    </div>
					    <div class="layui-inline">
					      <a class="layui-btn layui-btn-sm layui-btn-danger" onclick="delButton(this);"><i class="layui-icon">&#xe640;</i></a>
					    </div>
				  	</div>
				    <div id="filmImg" class="layui-inline">
						<div class="layui-inline">
							<img name="img" src="http://localhost:8081/static/img.jpg"  width="112" height="112" />	
					    </div>
					    <div class="layui-inline">
					      <a class="layui-btn layui-btn-sm layui-btn-danger" onclick="delButton(this);"><i class="layui-icon">&#xe640;</i></a>
					    </div>
				  	</div>
				</div>
			</fieldset>
			<input type="hidden" name="filmTidbits" id="filmTidbits">
  		</div>
  		<div class="layui-layer-btn layui-layer-btn" style="padding:8px 12px;z-index:1000;position: fixed;left: 1px;width: 97%;height: 40px; background:rgba(230,230,230,0.8)"> 
  			<a style="margin: 0px" class="layui-layer-btn0" type="submit" lay-submit="" lay-filter="save_info">保存</a>
  		</div>
  	</form>
</div>

<!--js区域  -->
<script>
var table;
var index = parent.layer.getFrameIndex(window.name);

layui.use(['form', 'layedit', 'laydate'], function(){
    var form = layui.form()
        ,layer = layui.layer
        ,layedit = layui.layedit
        ,laydate = layui.laydate;


form.on('submit(editModel)', function(data){
	var options = {
		url : ctx+"/admin/article/save-edit.do",
		type : "POST",
		dataType : 'json',
		success : function(result) {
			if (result.result == 1) {
				$.Loading.success(result.message);
				
			}
			if (result.result == 0) {
				$.Loading.error(result.message);
			}
		},
		error : function(e) {
			$.Loading.error("出现错误 ，请重试");
		}
	};
	$("#addmodelForm").ajaxSubmit(options);
	
	return false;
});

});

//修改字段弹框
	 function edit(fieldid){
		 var modelid=$("#modelid").val();
	　　	 layer.open({
	            title:"修改字段",//标题
	            maxmin :true,//右上角可否放大缩小
	            type:2,//弹框的类型
	            shade: [0.3, '#000'],//黑色背景
	            offset: '10px',//弹框位置
	            shadeClose:false,//黑色背景是否可以点击关闭
	            content:'${ctx}/cms/admin/field/edit.do?modelid='+modelid+'&fieldid='+fieldid+'&ajax=yes',//内容的URL
	            area:['700px','450px'],//弹框大小
	            scrollbar: true//是否允许浏览器出现滚动条
	        });
	 }

</script>
<#include '/admin/footer.html' >
