<#include '/admin/sonheader.html' >
<#assign dateformat= "com.enation.framework.directive.DateformateDirective"?new()>
<style >
  .layui-input{
    width: 75%;
  }
</style>
<div class="main">
    <!--表单区域  -->
	<form id="addExhibitionForm" class="layui-form" action="" enctype="multipart/form-data">
	    <div class="layui-form-item">
    		<label class="layui-form-label">分类：</label>
    		<div class="layui-input-block">
      			<select name="cat_id">
      			     <option>请选择分类</option>
      			     <option value="40">新闻公告</option>
      			     <option value="41">行业动态</option>
      			     <option value="42">科技之光</option>
      			     <option value="43">媒体声音</option>
      			</select>
    		</div>
  		</div>
  		<div class="layui-form-item">
  		<div class="layui-collapse" style="width:600px;margin-left: 30px;">
			<div class="layui-colla-item">
				<h2 class="layui-colla-title">基础属性</h2>
				<div class='layui-colla-content'>
					<#list specList as spec>
						<div class="layui-form-item">
							<label class="layui-form-label">${spec.spec_name}</label>
							<div class="layui-input-block">
								<#list specValList as specVal>
									<#if specVal.spec_id == spec.spec_id>
				    					<input name="specValId" title="${specVal.specval_name}" type="checkbox">
				    				</#if>
								</#list>
							</div>
						</div>
					</#list>
				</div>
			</div>
   		</div>
   		</div> 
  		<div class="layui-form-item">
    		<label class="layui-form-label">体验名称：</label>
    		<div class="layui-input-block">
      			<input type="text" name="title" id="uri" maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">体验说明：</label>
    		<div class="layui-input-block">
      			<input type="text" name="summary" id="pagename" maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">体验主图：</label>
    		<div class="layui-upload">
				<button type="button" class="layui-btn" id="test1">上传图片</button>
			  	<div class="layui-upload-list">
			    	<img class="layui-upload-img" id="demo1">
			    	<p id="demoText"></p>
			  	</div>
			</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">体验详情：</label>
    		<fieldset class="layui-elem-field site-demo-button" style="margin-top: 30px;">
				<legend>编辑区</legend>
				<div class="layui-form-item">
	    			<a class="layui-btn" onclick="add();">增加段落</a>
					<a class="layui-btn" onclick="addImg();">增加图片</a>
					<a class="layui-btn" onclick="getContext();">获取内容</a>
	  			</div>
				<div id="article">
				  <div class="layui-form-item">
				    <div class="layui-inline">
				      <textarea id="content" name="content" style="width: 500px;" placeholder="请输入内容" class="layui-textarea"></textarea>
				    </div>
				    <div class="layui-inline">
				      <a class="layui-btn layui-btn-sm layui-btn-danger" data-method="setTop" onclick="delButton(this);"><i class="layui-icon">&#xe640;</i></a>
				    </div>
				  </div>
				  <div class="layui-form-item">
				    <div class="layui-inline">
						<img name="img" src="file://E:/李涧明/日常处理/20171215/123123131/c.jpg"  width="112" height="112" />	
				    </div>
				    <div class="layui-inline">
				      <a class="layui-btn layui-btn-sm layui-btn-danger" onclick="delButton(this);"><i class="layui-icon">&#xe640;</i></a>
				    </div>
				  </div>
				</div>
			</fieldset>
  		</div>
  		<div class="layui-layer-btn layui-layer-btn" style="padding:8px 12px;z-index:1000;position: fixed;left: 1px;width: 97%;height: 40px; background:rgba(230,230,230,0.8)"> 
  			<a style="margin: 0px" class="layui-layer-btn0" type="submit" lay-submit="" lay-filter="save_info">保存</a>
  			<button class="layui-btn layui-btn-primary layui-btn-small" type="reset">还原</button>
  		</div>
  	</form>
</div>
<script>
var index = parent.layer.getFrameIndex(window.name);

function checkLength(){
	if($("#rolememo").val().length>100){
		$("#rolememo").val($("#rolememo").val().substring(0,100));
	}
}
layui.use(['form', 'layedit', 'laydate'], function(){
	var form = layui.form(),
    layedit = layui.layedit,
    laydate = layui.laydate;	
	
	form.on('submit(save_info)', function(data){
    	var options = {
   			url:ctx+"/core/admin/exhibition/add_save.do",
   			type:"post",
   			dataType:"json",
   			success:function(data){
   				if(data.result==1){	
   					$.Loading.success(data.message);
   					parent.layer.close(index); //再执行关闭        
   					parent.table.ajax.url(ctx+"/core/admin/exhibition/list-json.do").load();
   				}
   			}
   		};
   		$("#addExhibitionForm").ajaxSubmit(options);
       return false;
    });
});


function add(){
	$("#article").append("<div class='layui-form-item'>"+
		    "<div class='layui-inline'>"+
		      "<textarea id='content' name='desc' style='width: 500px;' placeholder='请输入内容' class='layui-textarea'></textarea>"+
		    "</div>"+
		    "<div class='layui-inline'>"+
		      "<a class='layui-btn layui-btn-sm layui-btn-danger' onclick='delButton(this);'><i class='layui-icon'>&#xe640;</i></a>"+
		    "</div>"+
		  "</div>");
}

function addImg(){
	$("#article").append("<div class='layui-form-item'>"+
		    "<div class='layui-inline'>"+
				"<img src='file://E:/李涧明/日常处理/20171215/123123131/c.jpg'  width='112' height='112' />"+	
	    	"</div>"+
	    	"<div class='layui-inline'>"+
	      		"<a class='layui-btn layui-btn-sm layui-btn-danger' onclick='delButton(this);'><i class='layui-icon'>&#xe640;</i></a>"+
	    	"</div>"+
	  	"</div>");
}

function delButton(k){
	 layer.confirm('确认要删除吗？', {
		  btn: ['删除','取消'] //按钮
		  ,area:['80px','150px']
		}, function(){
			$(k).parent().parent().remove();
		  	 layer.msg({
			    time: 20000
			 }); 
		}, function(){
		    layer.msg({
			    time: 20000
			}); 
		});
};

</script>
