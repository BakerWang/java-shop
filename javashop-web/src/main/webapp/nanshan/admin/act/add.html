<#include '/admin/sonheader.html' >
<#assign dateformat= "com.enation.framework.directive.DateformateDirective"?new()>
<style >
  .layui-input{
    width: 75%;
  }
</style>
<script type="text/javascript" src="${ctx}/nanshan/js/context.js"></script>

<div class="main">
    <!--表单区域  -->
	<form id="addUriForm" class="layui-form layui-form-pane" action="" enctype="multipart/form-data">
	    <#include '${ctx}/nanshan/common/spec.html' >
	     <div class="layui-form-item">
    		<label class="layui-form-label">分类：</label>
    		<div class="layui-input-block">
      			<select name="cat_id" id="cats">
      			     <option>请选择分类</option>
                    <option value="38">最新活动</option>
                    <option value="39">活动回顾</option>
      			</select>
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">文章标题：</label>
    		<div class="layui-input-block">
      			<input type="text" name="title" id="uri" maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">创建时间：</label>
    		<div class="layui-input-inline" >
      			<input class="layui-input" placeholder="创建时间" name="createTime" lay-verify="required" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD'})" style="width:100%;height:38px;" />
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">文章摘要：</label>
    		<div class="layui-input-block">
    		    <textarea name="summary" id="summary" style="height:100px" placeholder="请输入内容" class="layui-textarea"></textarea>
    		</div>
  		</div>
  		<div class="layui-form-item">
    		<label class="layui-form-label">文章大图：</label>
    		<div class="layui-input-block">
    		<img alt="" src="" >
    		</div>
  		</div>
  		<div id="act">
  		    <div class="layui-form-item">
	    		<label class="layui-form-label">截止时间：</label>
	    		<div class="layui-input-inline">
	    		<input class="layui-input" placeholder="截止时间" name="createTime" lay-verify="required" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD'})" style="width:100%;height:38px;" />
	    		</div>
  		    </div>
	  		<div class="layui-form-item">
	    		<label class="layui-form-label">活动对象：</label>
	    		<div class="layui-input-block">
	    		<input type="text" name=""  maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
	    		</div>
	  		</div>
	  		<div class="layui-form-item">
	    		<label class="layui-form-label">活动费用：</label>
	    		<div class="layui-input-block">
	    		<input type="text" name=""  maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
	    		</div>
	  		</div>
	  		<div class="layui-form-item">
	    		<label class="layui-form-label">活动地址：</label>
	    		<div class="layui-input-block">
	    		   <input type="text" name=""  maxlength="60" dataType="string" lay-verify="required" autocomplete="off" class="layui-input">
	    		</div>
	  		</div>
  		</div>
  		<#include '${ctx}/nanshan/common/context.html' >
  		<div class="layui-layer-btn layui-layer-btn-" style="padding:8px 12px;z-index:1000;position: fixed;left: 1px;width: 97%;height: 40px; background:rgba(230,230,230,0.8)"> 
  			<a style="margin: 0px" class="layui-layer-btn0" type="submit" lay-submit="" lay-filter="save_uri">保存</a>
  		</div>
  	</form>
</div>
<script>
var index = parent.layer.getFrameIndex(window.name);
function checkLength(){
	if($("#rolememo").val().length>100){
		$("#rolememo").val($("#rolememo").val().substring(0,100));
	}
}
layui.use(['form', 'layedit', 'laydate'], function(){
	var form = layui.form(),
    layedit = layui.layedit,
    laydate = layui.laydate;
    
	form.on('submit(save_uri)', function(data){
		var content=JSON.stringify(getContext());
		var actExt=JSON.stringify(getActExt());
		var specValue=getSpecValId();
		var content='{"content":'+content+',"actExt":'+actExt+'}';
    	var options = {
   			url:ctx+"/admin/article/add_save.do?catId=${catId}",
   			type:"post",
   			dataType:"json",
   			data:{"content":content,"specValIds":specValue},
   			success:function(data){
   				if(data.result==1){	
   					$.Loading.success(data.message);
   					parent.layer.close(index); //再执行关闭        
   					parent.table.ajax.url(ctx+"/admin/article/list-json.do?catId=${catId}").load();
   				}
   			}
   		};
   		$("#addUriForm").ajaxSubmit(options);
       return false;
    });
   
});





</script>



